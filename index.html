<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Food Hub - ระบบจัดการอาหารโรงเรียน</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans Thai', -apple-system, BlinkMacSystemFont, Arial, sans-serif;
            background: #f5f7fa;
            color: #333;
            font-size: 20px;
            line-height: 1.8;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 25px 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .header h1 {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 32px;
            font-weight: 600;
        }
        
        .header p {
            font-size: 18px;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        /* Voice Assistant */
        .voice-assistant {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .voice-btn {
            width: 80px;
            height: 80px;
            background: #FF5722;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(255, 87, 34, 0.4);
            transition: all 0.3s;
            border: none;
            position: relative;
        }
        
        .voice-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(255, 87, 34, 0.5);
        }
        
        .voice-btn.listening {
            animation: pulse 1.5s infinite;
            background: #F44336;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(244, 67, 54, 0); }
            100% { box-shadow: 0 0 0 0 rgba(244, 67, 54, 0); }
        }
        
        .voice-tooltip {
            position: absolute;
            bottom: 90px;
            right: 0;
            background: #333;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 16px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .voice-btn:hover .voice-tooltip {
            opacity: 1;
        }
        
        /* AI Assistant Box */
        .ai-assistant {
            background: #E3F2FD;
            border-left: 5px solid #2196F3;
            padding: 20px;
            margin: 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideIn 0.5s ease;
        }
        
        .ai-assistant .icon {
            font-size: 36px;
            color: #2196F3;
        }
        
        .ai-assistant .content h3 {
            font-size: 20px;
            margin-bottom: 5px;
            color: #1976D2;
        }
        
        .ai-assistant .content p {
            font-size: 18px;
            color: #555;
        }
        
        /* Navigation - Simplified */
        .nav-wrapper {
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-tabs {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 5px;
        }
        
        .nav-tab {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 25px;
            background: #f5f5f5;
            border: 3px solid transparent;
            border-radius: 15px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.3s;
            position: relative;
        }
        
        .nav-tab:hover {
            background: #e8f5e9;
            border-color: #4CAF50;
            transform: translateY(-2px);
        }
        
        .nav-tab.active {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        
        .nav-tab .icon {
            font-size: 24px;
        }
        
        .nav-tab .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #F44336;
            color: white;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Screen */
        .screen {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 25px;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(0,0,0,0.12);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: #4CAF50;
            transform: scaleY(0);
            transition: transform 0.3s;
        }
        
        .card:hover::before {
            transform: scaleY(1);
        }
        
        .card h3 {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }
        
        .card h3 .emoji {
            font-size: 30px;
        }
        
        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }
        
        /* Big Action Buttons */
        .action-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            width: 100%;
            padding: 25px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 0;
        }
        
        .action-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }
        
        .action-btn.secondary {
            background: #2196F3;
        }
        
        .action-btn.secondary:hover {
            background: #1976D2;
        }
        
        .action-btn.warning {
            background: #FF9800;
        }
        
        .action-btn.warning:hover {
            background: #F57C00;
        }
        
        .action-btn .icon {
            font-size: 30px;
        }
        
        /* Quick Actions Grid */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .quick-action-card {
            background: #f8f9fa;
            border: 3px solid #e0e0e0;
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quick-action-card:hover {
            background: white;
            border-color: #4CAF50;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .quick-action-card .icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .quick-action-card h4 {
            font-size: 18px;
            color: #333;
            margin-bottom: 8px;
        }
        
        .quick-action-card p {
            font-size: 16px;
            color: #666;
        }
        
        /* Status Cards */
        .status-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .status-card.good { background: #E8F5E9; }
        .status-card.warning { background: #FFF3CD; }
        .status-card.danger { background: #FFEBEE; }
        
        .status-card h4 {
            font-size: 18px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .status-card .value {
            font-size: 36px;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .status-card.good .value { color: #4CAF50; }
        .status-card.warning .value { color: #FF9800; }
        .status-card.danger .value { color: #F44336; }
        
        /* Step Guide */
        .step-guide {
            background: #FFF9C4;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }
        
        .step-guide h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 22px;
            margin-bottom: 20px;
            color: #F57F17;
        }
        
        .step {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .step:hover {
            transform: translateX(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .step .number {
            width: 50px;
            height: 50px;
            background: #4CAF50;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
        }
        
        .step.completed .number {
            background: #4CAF50;
        }
        
        .step.current .number {
            background: #FF9800;
            animation: pulse 2s infinite;
        }
        
        /* Food Exchange Cards */
        .exchange-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .exchange-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .exchange-image {
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            position: relative;
        }
        
        .exchange-image.green { background: #81C784; }
        .exchange-image.blue { background: #64B5F6; }
        .exchange-image.orange { background: #FFB74D; }
        
        .exchange-tag {
            position: absolute;
            top: 15px;
            right: 15px;
            background: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .exchange-info {
            padding: 25px;
        }
        
        .exchange-info h4 {
            font-size: 22px;
            margin-bottom: 15px;
        }
        
        .exchange-info .detail {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            font-size: 18px;
            color: #666;
        }
        
        .exchange-info .detail .icon {
            color: #4CAF50;
        }
        
        /* Input Fields - Bigger and Clearer */
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group label {
            display: block;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }
        
        .input-field {
            width: 100%;
            padding: 18px 20px;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }
        
        /* Camera Scanner */
        .camera-scanner {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            text-align: center;
        }
        
        .camera-viewfinder {
            width: 100%;
            max-width: 400px;
            height: 300px;
            background: #000;
            border-radius: 15px;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .camera-viewfinder video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .camera-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 250px;
            height: 250px;
            border: 3px solid #4CAF50;
            border-radius: 20px;
            pointer-events: none;
        }
        
        .camera-corners {
            position: absolute;
            width: 30px;
            height: 30px;
        }
        
        .camera-corners::before,
        .camera-corners::after {
            content: '';
            position: absolute;
            background: #4CAF50;
        }
        
        .camera-corners.top-left {
            top: -3px;
            left: -3px;
        }
        
        .camera-corners.top-left::before {
            width: 30px;
            height: 3px;
        }
        
        .camera-corners.top-left::after {
            width: 3px;
            height: 30px;
        }
        
        .camera-corners.top-right {
            top: -3px;
            right: -3px;
        }
        
        .camera-corners.top-right::before {
            width: 30px;
            height: 3px;
            right: 0;
        }
        
        .camera-corners.top-right::after {
            width: 3px;
            height: 30px;
            right: 0;
        }
        
        .camera-corners.bottom-left {
            bottom: -3px;
            left: -3px;
        }
        
        .camera-corners.bottom-left::before {
            width: 30px;
            height: 3px;
            bottom: 0;
        }
        
        .camera-corners.bottom-left::after {
            width: 3px;
            height: 30px;
            bottom: 0;
        }
        
        .camera-corners.bottom-right {
            bottom: -3px;
            right: -3px;
        }
        
        .camera-corners.bottom-right::before {
            width: 30px;
            height: 3px;
            bottom: 0;
            right: 0;
        }
        
        .camera-corners.bottom-right::after {
            width: 3px;
            height: 30px;
            bottom: 0;
            right: 0;
        }
        
        .scan-result {
            background: #E8F5E9;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }
        
        .scan-result.active {
            display: block;
        }
        
        .nutrition-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .nutrition-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.3s;
        }
        
        .nutrition-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .nutrition-item h5 {
            font-size: 16px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .nutrition-item .value {
            font-size: 24px;
            font-weight: 700;
            color: #4CAF50;
        }
        
        /* Help Tips */
        .help-tip {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: #2196F3;
            color: white;
            border-radius: 50%;
            font-size: 14px;
            font-weight: bold;
            cursor: help;
            margin-left: 10px;
        }
        
        /* Loading State */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,.1);
            border-radius: 50%;
            border-top-color: #4CAF50;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            body { font-size: 18px; }
            .header h1 { font-size: 26px; }
            .grid { grid-template-columns: 1fr; }
            .quick-actions { grid-template-columns: repeat(2, 1fr); }
            .nav-tab { padding: 12px 20px; font-size: 16px; }
            .voice-btn { width: 70px; height: 70px; font-size: 30px; }
            .camera-viewfinder { height: 250px; }
        }
        
        /* Notification Badge */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: slideInRight 0.5s ease;
            z-index: 1000;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>🌾 School Food Hub</h1>
        <p>ระบบจัดการอาหารโรงเรียน - ใช้ง่าย ประหยัดเงิน</p>
    </div>
    
    <!-- Navigation -->
    <div class="nav-wrapper">
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showScreen('home')">
                <span class="icon">🏠</span>
                <span>หน้าแรก</span>
            </div>
            <div class="nav-tab" onclick="showScreen('quick-start')">
                <span class="icon">⚡</span>
                <span>เริ่มด่วน</span>
                <span class="badge">ใหม่</span>
            </div>
            <div class="nav-tab" onclick="showScreen('dashboard')">
                <span class="icon">📊</span>
                <span>สถานะวันนี้</span>
            </div>
            <div class="nav-tab" onclick="showScreen('exchange')">
                <span class="icon">🔄</span>
                <span>แลกเปลี่ยน</span>
            </div>
            <div class="nav-tab" onclick="showScreen('ai-menu')">
                <span class="icon">🤖</span>
                <span>AI ช่วยเมนู</span>
            </div>
            <div class="nav-tab" onclick="showScreen('nutrition')">
                <span class="icon">📈</span>
                <span>โภชนาการ</span>
            </div>
            <div class="nav-tab" onclick="showScreen('community')">
                <span class="icon">🤝</span>
                <span>ชุมชน</span>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Home Screen -->
        <div id="home" class="screen active">
            <!-- AI Assistant Welcome -->
            <div class="ai-assistant">
                <div class="icon">🤖</div>
                <div class="content">
                    <h3>สวัสดีค่ะ! AI ผู้ช่วยพร้อมช่วยคุณแล้ว</h3>
                    <p>วันนี้คุณมีงบ 1,250 บาท แต่ต้องใช้ 1,870 บาท ขาดอีก 620 บาท - ลองกดปุ่ม "แก้ปัญหาด่วน" ด้านล่างนะคะ</p>
                    <p style="margin-top: 10px; color: #FF9800;">⚠️ มีนักเรียน 8 คนที่ต้องดูแลภาวะโภชนาการเป็นพิเศษ</p>
                </div>
            </div>
            
            <!-- Quick Status -->
            <div class="grid" style="margin-bottom: 30px;">
                <div class="status-card danger">
                    <h4>💰 งบประมาณวันนี้</h4>
                    <div class="value">฿1,250</div>
                    <p>ขาดอีก ฿620</p>
                </div>
                <div class="status-card good">
                    <h4>👦 นักเรียน</h4>
                    <div class="value">85 คน</div>
                    <p>ทุกคนมาครบ</p>
                </div>
                <div class="status-card warning">
                    <h4>🥬 วัตถุดิบ</h4>
                    <div class="value">3 วัน</div>
                    <p>ใกล้หมด</p>
                </div>
            </div>
            
            <!-- Big Action Button - Fixed to navigate to solution screen -->
            <button class="action-btn warning" onclick="showScreen('quick-solution')">
                <span class="icon">⚡</span>
                <span>แก้ปัญหาด่วน - ขาดเงิน 620 บาท</span>
            </button>
            
            <!-- Quick Actions -->
            <h3 style="margin-top: 40px; margin-bottom: 20px;">🎯 ทำอะไรได้บ้าง?</h3>
            <div class="quick-actions">
                <div class="quick-action-card" onclick="showScreen('exchange')">
                    <div class="icon">🔄</div>
                    <h4>แลกวัตถุดิบ</h4>
                    <p>มีไข่เหลือ 50 ฟอง</p>
                </div>
                <div class="quick-action-card" onclick="showScreen('ai-menu')">
                    <div class="icon">🤖</div>
                    <h4>AI ช่วยเมนู</h4>
                    <p>ประหยัดอัตโนมัติ</p>
                </div>
                <div class="quick-action-card" onclick="showScreen('nutrition')">
                    <div class="icon">📈</div>
                    <h4>ติดตามโภชนาการ</h4>
                    <p>8 คนต้องดูแลพิเศษ</p>
                </div>
                <div class="quick-action-card" onclick="showVoiceCommand()">
                    <div class="icon">🎤</div>
                    <h4>สั่งด้วยเสียง</h4>
                    <p>พูดสิ่งที่ต้องการ</p>
                </div>
                <div class="quick-action-card" onclick="showScreen('community')">
                    <div class="icon">🆘</div>
                    <h4>ขอความช่วยเหลือ</h4>
                    <p>จากชุมชน</p>
                </div>
            </div>
        </div>
        
        <!-- Quick Solution Screen (New) -->
        <div id="quick-solution" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">⚡ แก้ปัญหาเงินไม่พอ</h2>
            
            <div class="ai-assistant">
                <div class="icon">💡</div>
                <div class="content">
                    <h3>AI วิเคราะห์แล้ว! มี 4 วิธีแก้ปัญหา</h3>
                    <p>เลือกวิธีที่เหมาะสมกับคุณที่สุด หรือใช้หลายวิธีรวมกันก็ได้</p>
                </div>
            </div>
            
            <div class="step-guide">
                <h3>
                    <span>✅</span>
                    <span>วิธีแก้ปัญหาที่แนะนำ</span>
                </h3>
                
                <div class="step" onclick="showScreen('exchange')">
                    <div class="number">1</div>
                    <div>
                        <h4>แลกไข่ 30 ฟอง → ได้ปลา 5 กก.</h4>
                        <p>ประหยัด 200 บาท - โรงเรียนบ้านดอย</p>
                    </div>
                </div>
                
                <div class="step" onclick="useFreeVegetables()">
                    <div class="number">2</div>
                    <div>
                        <h4>ใช้ผักจากสวนโรงเรียน</h4>
                        <p>ประหยัด 150 บาท - มีผักคะน้า, ผักบุ้ง</p>
                    </div>
                </div>
                
                <div class="step" onclick="showPartnerStores()">
                    <div class="number">3</div>
                    <div>
                        <h4>ซื้อจากร้านพันธมิตร</h4>
                        <p>ประหยัด 80 บาท - ร้านป้าศรีลด 10%</p>
                    </div>
                </div>
                
                <div class="step" onclick="showScreen('community')">
                    <div class="number">4</div>
                    <div>
                        <h4>ขอความช่วยเหลือจากชุมชน</h4>
                        <p>ประหยัด 200 บาท - ลุงโตให้ผักฟรี</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3><span class="emoji">📊</span> สรุปการประหยัด</h3>
                <div style="background: #E8F5E9; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 24px; font-weight: 700; color: #4CAF50; text-align: center; margin-bottom: 15px;">
                        รวมประหยัดได้: 630 บาท ✅
                    </div>
                    <p style="text-align: center;">เพียงพอสำหรับค่าอาหารวันนี้แล้ว!</p>
                </div>
                <button class="action-btn" onclick="applyAllSolutions()">
                    <span class="icon">✅</span>
                    <span>ใช้ทุกวิธีเลย</span>
                </button>
            </div>
        </div>
        
        <!-- Quick Start Screen -->
        <div id="quick-start" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">⚡ เริ่มต้นใช้งานง่ายๆ</h2>
            
            <div class="step-guide">
                <h3>
                    <span>💡</span>
                    <span>ทำตามขั้นตอนนี้ได้เลย</span>
                </h3>
                
                <div class="step completed" onclick="showScreen('dashboard')">
                    <div class="number">✓</div>
                    <div>
                        <h4>1. ดูสถานะวันนี้</h4>
                        <p>เช็คงบประมาณและวัตถุดิบ</p>
                    </div>
                </div>
                
                <div class="step current" onclick="showScreen('quick-solution')">
                    <div class="number">2</div>
                    <div>
                        <h4>2. แก้ปัญหาเงินไม่พอ</h4>
                        <p>ระบบช่วยหาวิธีให้อัตโนมัติ</p>
                    </div>
                </div>
                
                <div class="step" onclick="showScreen('exchange')">
                    <div class="number">3</div>
                    <div>
                        <h4>3. แลกเปลี่ยนวัตถุดิบ</h4>
                        <p>แลกของที่มีกับของที่ต้องการ</p>
                    </div>
                </div>
                
                <div class="step" onclick="showScreen('ai-menu')">
                    <div class="number">4</div>
                    <div>
                        <h4>4. ให้ AI ช่วยวางเมนู</h4>
                        <p>สร้างเมนูประหยัดอัตโนมัติ</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>🎥 ดูวิดีโอสอนใช้งาน (3 นาที)</h3>
                <button class="action-btn secondary" onclick="playTutorial()">
                    <span class="icon">▶️</span>
                    <span>เล่นวิดีโอ</span>
                </button>
            </div>
        </div>
        
        <!-- Dashboard Screen -->
        <div id="dashboard" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">📊 สถานะวันนี้</h2>
            
            <!-- AI Alert -->
            <div class="ai-assistant">
                <div class="icon">⚠️</div>
                <div class="content">
                    <h3>AI แจ้งเตือน: เงินไม่พอสำหรับวันนี้</h3>
                    <p>ขาด 620 บาท - แนะนำให้แลกไข่กับปลา และใช้ผักจากสวนโรงเรียน จะประหยัดได้ 650 บาท</p>
                </div>
            </div>
            
            <div class="grid">
                <div class="card" onclick="showBudgetDetail()">
                    <h3><span class="emoji">💰</span> งบประมาณ</h3>
                    <div style="font-size: 36px; color: #F44336; font-weight: 700;">฿1,250</div>
                    <p>ต้องใช้: ฿1,870 (ขาด ฿620)</p>
                    <button class="action-btn" style="margin-top: 20px;" onclick="showScreen('quick-solution')">ดูวิธีแก้ปัญหา</button>
                </div>
                
                <div class="card" onclick="showInventory()">
                    <h3><span class="emoji">🥚</span> วัตถุดิบในคลัง</h3>
                    <ul style="list-style: none; padding: 0; font-size: 20px; line-height: 2;">
                        <li>🥚 ไข่ไก่: 120 ฟอง ✅</li>
                        <li>🥬 ผักคะน้า: 15 กก. ⚠️</li>
                        <li>🌾 ข้าวสาร: 50 กก. ✅</li>
                    </ul>
                    <button class="action-btn secondary" style="margin-top: 20px;" onclick="showFullInventory()">ดูทั้งหมด</button>
                </div>
                
                <div class="card" onclick="showTodayMenu()">
                    <h3><span class="emoji">🍛</span> เมนูวันนี้</h3>
                    <div style="background: #f5f5f5; padding: 20px; border-radius: 10px;">
                        <h4>ข้าวผัดไข่ + ผักคะน้า</h4>
                        <p>ต้นทุน: ฿22/คน</p>
                        <p>โภชนาการ: ⭐⭐⭐⭐⭐</p>
                    </div>
                    <button class="action-btn" style="margin-top: 20px;" onclick="showScreen('ai-menu')">เปลี่ยนเมนู</button>
                </div>
                
                <div class="card" onclick="showScreen('nutrition')">
                    <h3><span class="emoji">📈</span> ภาวะโภชนาการ</h3>
                    <div style="background: #E8F5E9; padding: 20px; border-radius: 10px;">
                        <p>✅ ปกติ: 64 คน (75%)</p>
                        <p>⚠️ เฝ้าระวัง: 13 คน (15%)</p>
                        <p>🚨 ดูแลพิเศษ: 8 คน (10%)</p>
                    </div>
                    <button class="action-btn warning" style="margin-top: 20px;">ดูรายละเอียด</button>
                </div>
            </div>
        </div>
        
        <!-- Exchange Screen -->
        <div id="exchange" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">🔄 แลกเปลี่ยนวัตถุดิบ</h2>
            
            <!-- AI Recommendation -->
            <div class="ai-assistant">
                <div class="icon">💡</div>
                <div class="content">
                    <h3>AI แนะนำ: คุณมีไข่เหลือ 50 ฟอง</h3>
                    <p>ลองแลกกับปลาจากโรงเรียนบ้านดอย จะประหยัดได้ 200 บาท และได้โปรตีนครบถ้วน</p>
                </div>
            </div>
            
            <div class="grid">
                <div class="exchange-card" onclick="confirmExchange('ปลานิล')">
                    <div class="exchange-image blue">
                        🐟
                        <span class="exchange-tag">แนะนำ</span>
                    </div>
                    <div class="exchange-info">
                        <h4>ปลานิล 5 กก.</h4>
                        <div class="detail">
                            <span class="icon">📍</span>
                            <span>โรงเรียนบ้านดอย (3 กม.)</span>
                        </div>
                        <div class="detail">
                            <span class="icon">🔄</span>
                            <span>ต้องการ: ไข่ไก่ 30 ฟอง</span>
                        </div>
                        <div class="detail">
                            <span class="icon">💰</span>
                            <span>ประหยัด: 200 บาท</span>
                        </div>
                        <button class="action-btn" style="margin-top: 15px;">แลกเปลี่ยนเลย</button>
                    </div>
                </div>
                
                <div class="exchange-card" onclick="confirmExchange('ผักบุ้ง')">
                    <div class="exchange-image green">
                        🥬
                    </div>
                    <div class="exchange-info">
                        <h4>ผักบุ้ง 10 กก.</h4>
                        <div class="detail">
                            <span class="icon">📍</span>
                            <span>โรงเรียนบ้านห้วย (5 กม.)</span>
                        </div>
                        <div class="detail">
                            <span class="icon">🔄</span>
                            <span>ต้องการ: ไข่ไก่ 20 ฟอง</span>
                        </div>
                        <div class="detail">
                            <span class="icon">💰</span>
                            <span>ประหยัด: 150 บาท</span>
                        </div>
                        <button class="action-btn secondary" style="margin-top: 15px;">แลกเปลี่ยน</button>
                    </div>
                </div>
            </div>
            
            <button class="action-btn warning" style="margin-top: 30px;" onclick="showMoreExchanges()">
                <span class="icon">➕</span>
                <span>ดูข้อเสนอแลกเปลี่ยนเพิ่มเติม</span>
            </button>
        </div>
        
        <!-- AI Menu Planning Screen -->
        <div id="ai-menu" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">🤖 AI ช่วยวางแผนเมนู</h2>
            
            <div class="card">
                <h3>💬 บอก AI สิ่งที่คุณต้องการ</h3>
                <div class="input-group">
                    <textarea class="input-field" rows="3" placeholder="เช่น: ต้องการเมนูประหยัด ใช้ไข่และผัก งบไม่เกิน 20 บาท/คน"></textarea>
                </div>
                <button class="action-btn" onclick="generateAIMenu()">
                    <span class="icon">🤖</span>
                    <span>สร้างเมนูอัตโนมัติ</span>
                </button>
            </div>
            
            <!-- New Camera Scanner Feature -->
            <div class="camera-scanner">
                <h3>📸 สแกนวัตถุดิบเพื่อดูคุณค่าทางโภชนาการ</h3>
                <p style="margin-bottom: 20px;">ถ่ายรูปวัตถุดิบที่มี AI จะวิเคราะห์โภชนาการให้ทันที</p>
                
                <div class="camera-viewfinder" id="cameraViewfinder">
                    <video id="cameraStream" style="display: none;"></video>
                    <div class="camera-overlay">
                        <div class="camera-corners top-left"></div>
                        <div class="camera-corners top-right"></div>
                        <div class="camera-corners bottom-left"></div>
                        <div class="camera-corners bottom-right"></div>
                    </div>
                    <div id="cameraPlaceholder" style="color: white; font-size: 60px;">📷</div>
                </div>
                
                <button class="action-btn secondary" id="scanButton" onclick="startCameraScanning()">
                    <span class="icon">📸</span>
                    <span>เปิดกล้องสแกน</span>
                </button>
                
                <button class="action-btn warning" id="captureButton" style="display: none;" onclick="captureAndAnalyze()">
                    <span class="icon">📸</span>
                    <span>ถ่ายรูปวิเคราะห์</span>
                </button>
                
                <div class="scan-result" id="scanResult">
                    <h4>🥚 ผลการสแกน: ไข่ไก่ (100 กรัม)</h4>
                    <div class="nutrition-info">
                        <div class="nutrition-item">
                            <h5>พลังงาน</h5>
                            <div class="value">155 kcal</div>
                        </div>
                        <div class="nutrition-item">
                            <h5>โปรตีน</h5>
                            <div class="value">13 g</div>
                        </div>
                        <div class="nutrition-item">
                            <h5>ไขมัน</h5>
                            <div class="value">11 g</div>
                        </div>
                        <div class="nutrition-item">
                            <h5>คาร์โบไฮเดรต</h5>
                            <div class="value">1.1 g</div>
                        </div>
                    </div>
                    <button class="action-btn" style="margin-top: 20px;" onclick="addToMenu()">
                        <span class="icon">➕</span>
                        <span>เพิ่มในเมนูวันนี้</span>
                    </button>
                </div>
            </div>
            
            <div id="ai-menu-result" style="display: none;">
                <h3 style="margin: 30px 0;">📋 เมนูที่ AI แนะนำ</h3>
                <div class="card">
                    <h4>เมนูประหยัด 5 วัน (เฉลี่ย 18 บาท/คน)</h4>
                    <div style="font-size: 18px; line-height: 2; margin-top: 20px;">
                        <p><strong>จันทร์:</strong> ข้าวผัดไข่ + ผักคะน้าลวก (17 บาท)</p>
                        <p><strong>อังคาร:</strong> ไข่พะโล้ + ผักบุ้งไฟแดง (19 บาท)</p>
                        <p><strong>พุธ:</strong> แกงจืดเต้าหู้ไข่ (16 บาท)</p>
                        <p><strong>พฤหัส:</strong> ผัดผักรวมใส่ไข่ (18 บาท)</p>
                        <p><strong>ศุกร์:</strong> ข้าวไข่เจียว + น้ำพริก (20 บาท)</p>
                    </div>
                    <div style="background: #E8F5E9; padding: 20px; border-radius: 10px; margin-top: 20px;">
                        <p><strong>✅ ประหยัดได้:</strong> 110 บาท/วัน</p>
                        <p><strong>✅ โภชนาการ:</strong> ครบ 5 หมู่ทุกมื้อ</p>
                        <p><strong>✅ ใช้วัตถุดิบที่มี:</strong> ไข่, ผัก, ข้าว</p>
                    </div>
                    <button class="action-btn" style="margin-top: 20px;" onclick="useAIMenu()">ใช้เมนูนี้</button>
                </div>
            </div>
        </div>
        
        <!-- Nutrition Tracking Screen -->
        <div id="nutrition" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">📈 ติดตามภาวะโภชนาการนักเรียน</h2>
            
            <!-- AI Summary -->
            <div class="ai-assistant">
                <div class="icon">💡</div>
                <div class="content">
                    <h3>สรุปภาพรวมประจำสัปดาห์</h3>
                    <p>นักเรียน 75% มีภาวะโภชนาการปกติ | 15% ต้องเฝ้าระวัง | 10% ต้องดูแลเป็นพิเศษ</p>
                </div>
            </div>
            
            <!-- Quick Stats -->
            <div class="grid" style="margin-bottom: 30px;">
                <div class="status-card good">
                    <h4>👦 ภาวะปกติ</h4>
                    <div class="value">64 คน</div>
                    <p>75% ของทั้งหมด</p>
                </div>
                <div class="status-card warning">
                    <h4>⚠️ เฝ้าระวัง</h4>
                    <div class="value">13 คน</div>
                    <p>15% ของทั้งหมด</p>
                </div>
                <div class="status-card danger">
                    <h4>🚨 ดูแลพิเศษ</h4>
                    <div class="value">8 คน</div>
                    <p>10% ของทั้งหมด</p>
                </div>
            </div>
            
            <!-- Big Action Buttons -->
            <div class="quick-actions">
                <div class="quick-action-card" onclick="startQuickMeasure()">
                    <div class="icon">📏</div>
                    <h4>วัดส่วนสูง-น้ำหนัก</h4>
                    <p>อัปเดตข้อมูลรวดเร็ว</p>
                </div>
                <div class="quick-action-card" onclick="showRiskStudents()">
                    <div class="icon">🚨</div>
                    <h4>ดูเด็กกลุ่มเสี่ยง</h4>
                    <p>13 คนต้องเฝ้าระวัง</p>
                </div>
                <div class="quick-action-card" onclick="showNutritionReport()">
                    <div class="icon">📊</div>
                    <h4>รายงานประจำเดือน</h4>
                    <p>พร้อมส่งให้ผู้ปกครอง</p>
                </div>
                <div class="quick-action-card" onclick="printNutritionReport()">
                    <div class="icon">🖨️</div>
                    <h4>พิมพ์รายงาน</h4>
                    <p>สำหรับส่ง สสจ.</p>
                </div>
                <div class="quick-action-card" onclick="showFoodRecommend()">
                    <div class="icon">🍽️</div>
                    <h4>เมนูแนะนำ</h4>
                    <p>เพิ่มโภชนาการ</p>
                </div>
            </div>
            
            <!-- Progress Chart -->
            <div class="card">
                <h3><span class="emoji">📊</span> ความก้าวหน้า 6 เดือนที่ผ่านมา</h3>
                <div style="background: #f5f5f5; padding: 30px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 20px;">📈</div>
                    <div class="grid" style="margin-top: 20px;">
                        <div>
                            <h4 style="color: #4CAF50;">ดีขึ้น ✅</h4>
                            <p style="font-size: 32px; font-weight: 700; color: #4CAF50;">45%</p>
                            <p>ลดเด็กน้ำหนักต่ำ</p>
                        </div>
                        <div>
                            <h4 style="color: #2196F3;">ส่วนสูงเพิ่ม 📏</h4>
                            <p style="font-size: 32px; font-weight: 700; color: #2196F3;">+3.2 ซม.</p>
                            <p>เฉลี่ยต่อคน</p>
                        </div>
                        <div>
                            <h4 style="color: #FF9800;">BMI ปกติ ⚖️</h4>
                            <p style="font-size: 32px; font-weight: 700; color: #FF9800;">82%</p>
                            <p>อยู่ในเกณฑ์ดี</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Measure Form -->
            <div class="card" id="quickMeasureForm" style="display: none;">
                <h3><span class="emoji">📏</span> วัดส่วนสูง-น้ำหนักด่วน</h3>
                <div class="step-guide" style="background: #E3F2FD; margin-bottom: 20px;">
                    <p style="font-size: 18px;">💡 <strong>เคล็ดลับ:</strong> วัดตอนเช้าก่อนรับประทานอาหาร จะได้ค่าที่แม่นยำที่สุด</p>
                </div>
                
                <div class="input-group">
                    <label>เลือกนักเรียน</label>
                    <select class="input-field" id="studentSelect">
                        <option value="">-- กดเลือกชื่อนักเรียน --</option>
                        <option value="1">ด.ช. สมชาย ใจดี (ป.1)</option>
                        <option value="2">ด.ญ. สมหญิง รักเรียน (ป.1)</option>
                        <option value="3">ด.ช. มานะ ขยัน (ป.2)</option>
                    </select>
                </div>
                
                <div class="grid">
                    <div class="input-group">
                        <label>น้ำหนัก (กิโลกรัม)</label>
                        <input type="number" class="input-field" placeholder="เช่น 25.5" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>ส่วนสูง (เซนติเมตร)</label>
                        <input type="number" class="input-field" placeholder="เช่น 120" step="0.1">
                    </div>
                </div>
                
                <button class="action-btn" onclick="saveMeasurement()">
                    <span class="icon">💾</span>
                    <span>บันทึกข้อมูล</span>
                </button>
                <button class="action-btn secondary" onclick="cancelMeasure()">
                    <span class="icon">❌</span>
                    <span>ยกเลิก</span>
                </button>
            </div>
            
            <!-- AI Recommendations -->
            <div class="card">
                <h3><span class="emoji">🤖</span> คำแนะนำจาก AI สำหรับสัปดาห์นี้</h3>
                <div class="step-guide">
                    <div class="step">
                        <div class="number">1</div>
                        <div>
                            <h4>เพิ่มแคลเซียม</h4>
                            <p>นักเรียน 30% ได้แคลเซียมไม่พอ แนะนำเพิ่มนม ปลาตัวเล็ก หรือผักใบเขียว</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="number">2</div>
                        <div>
                            <h4>โปรตีนคุณภาพ</h4>
                            <p>ใช้ไข่จากโครงการเลี้ยงไก่ + ปลาจากบ่อโรงเรียน ประหยัด 200 บาท/วัน</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="number">3</div>
                        <div>
                            <h4>ผักสด 5 สี</h4>
                            <p>ปลูกผักหมุนเวียน: ผักบุ้ง คะน้า กวางตุ้ง ผักกาด มะเขือ</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Success Stories -->
            <div class="card" style="background: #E8F5E9;">
                <h3><span class="emoji">🌟</span> เรื่องราวความสำเร็จ</h3>
                <div style="display: flex; align-items: center; gap: 20px; margin: 20px 0;">
                    <div style="font-size: 60px;">👦</div>
                    <div>
                        <h4>น้องมานะ - จากน้ำหนักต่ำสู่ปกติใน 4 เดือน</h4>
                        <p>น้ำหนักเพิ่ม 3.5 กก. | ส่วนสูงเพิ่ม 4 ซม. | สมาธิในการเรียนดีขึ้น</p>
                        <p style="color: #666; margin-top: 10px;">"เมนูไข่ตุ๋น + ผักจากสวนโรงเรียน ช่วยได้มาก" - ครูประจำชั้น</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Community Screen (Simplified) -->
        <div id="community" class="screen">
            <h2 style="text-align: center; margin-bottom: 30px;">🤝 ชุมชนช่วยเหลือ</h2>
            
            <div class="grid">
                <div class="card">
                    <h3><span class="emoji">🏪</span> ร้านค้าพันธมิตร</h3>
                    <ul style="font-size: 20px; line-height: 2.5;">
                        <li>🏪 ร้านป้าศรี - ลด 10%</li>
                        <li>🥬 สวนลุงโต - ผักฟรีทุกศุกร์</li>
                        <li>🐟 บ่อปลาชุมชน - ราคาพิเศษ</li>
                    </ul>
                    <button class="action-btn secondary" style="margin-top: 20px;" onclick="showAllPartners()">ดูทั้งหมด</button>
                </div>
                
                <div class="card">
                    <h3><span class="emoji">🆘</span> ขอความช่วยเหลือ</h3>
                    <p style="font-size: 20px; margin-bottom: 20px;">วันนี้ขาดเงิน 620 บาท</p>
                    <button class="action-btn warning" onclick="sendHelpRequest()">
                        <span class="icon">📢</span>
                        <span>ส่งคำขอช่วยเหลือ</span>
                    </button>
                    <p style="margin-top: 20px; color: #666;">ระบบจะส่งข้อความไปยังกลุ่มชุมชนทันที</p>
                </div>
            </div>
            
            <div class="card">
                <h3><span class="emoji">💝</span> ผู้สนับสนุนล่าสุด</h3>
                <div style="background: #f5f5f5; padding: 20px; border-radius: 10px;">
                    <p style="margin: 10px 0;">🙏 คุณสมชาย - บริจาค 500 บาท</p>
                    <p style="margin: 10px 0;">🥬 สวนผักลุงใจดี - ผักสด 20 กก.</p>
                    <p style="margin: 10px 0;">🌾 ร้านข้าวป้าแดง - ข้าวสาร 10 กก.</p>
                </div>
                <button class="action-btn" style="margin-top: 20px;" onclick="showDonationHistory()">ดูประวัติทั้งหมด</button>
            </div>
        </div>
    </div>
    
    <!-- Voice Assistant Button -->
    <div class="voice-assistant">
        <button class="voice-btn" onclick="toggleVoice()" id="voiceBtn">
            🎤
            <span class="voice-tooltip">กดเพื่อพูดคำสั่ง</span>
        </button>
    </div>
    
    <script>
        // Global state
        let isListening = false;
        let currentScreen = 'home';
        let isCameraActive = false;
        let stream = null;
        
        // Screen navigation
        function showScreen(screenId) {
            // Stop camera if switching screens
            if (isCameraActive && screenId !== 'ai-menu') {
                stopCamera();
            }
            
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show selected screen
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                currentScreen = screenId;
            } else {
                // Create quick-solution screen if it doesn't exist
                if (screenId === 'quick-solution') {
                    createQuickSolutionScreen();
                }
            }
            
            // Update navigation
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Find and activate the right tab
            const tabs = document.querySelectorAll('.nav-tab');
            const screenMap = {
                'home': 0,
                'quick-start': 1,
                'dashboard': 2,
                'exchange': 3,
                'ai-menu': 4,
                'nutrition': 5,
                'community': 6
            };
            
            if (tabs[screenMap[screenId]]) {
                tabs[screenMap[screenId]].classList.add('active');
            }
            
            // Show notification
            if (screenId !== 'home') {
                const screenNames = {
                    'quick-solution': 'แก้ปัญหาเงินไม่พอ',
                    'quick-start': 'เริ่มด่วน',
                    'dashboard': 'สถานะวันนี้',
                    'exchange': 'แลกเปลี่ยน',
                    'ai-menu': 'AI ช่วยเมนู',
                    'nutrition': 'ติดตามโภชนาการ',
                    'community': 'ชุมชน'
                };
                showNotification(`กำลังแสดง: ${screenNames[screenId] || 'หน้าใหม่'}`);
            }
        }
        
        // Voice Assistant
        function toggleVoice() {
            const voiceBtn = document.getElementById('voiceBtn');
            isListening = !isListening;
            
            if (isListening) {
                voiceBtn.classList.add('listening');
                startListening();
            } else {
                voiceBtn.classList.remove('listening');
                stopListening();
            }
        }
        
        function startListening() {
            // Simulate voice recognition
            showNotification('🎤 กำลังฟัง... พูดคำสั่งของคุณ');
            
            // Simulate voice command after 3 seconds
            setTimeout(() => {
                if (isListening) {
                    processVoiceCommand("ขาดเงินค่าอาหาร");
                    toggleVoice();
                }
            }, 3000);
        }
        
        function stopListening() {
            showNotification('🔇 หยุดฟังแล้ว');
        }
        
        function processVoiceCommand(command) {
            showNotification(`📢 คุณพูดว่า: "${command}"`);
            
            // Process command
            if (command.includes('ขาดเงิน') || command.includes('เงินไม่พอ')) {
                setTimeout(() => {
                    showScreen('quick-solution');
                }, 1000);
            } else if (command.includes('แลก') || command.includes('ไข่')) {
                setTimeout(() => {
                    showScreen('exchange');
                }, 1000);
            } else if (command.includes('เมนู')) {
                setTimeout(() => {
                    showScreen('ai-menu');
                }, 1000);
            } else if (command.includes('สแกน') || command.includes('ถ่ายรูป')) {
                setTimeout(() => {
                    showScreen('ai-menu');
                    startCameraScanning();
                }, 1000);
            } else if (command.includes('โภชนาการ') || command.includes('น้ำหนัก') || command.includes('ส่วนสูง')) {
                setTimeout(() => {
                    showScreen('nutrition');
                }, 1000);
            }
        }
        
        function showVoiceCommand() {
            alert('🎤 วิธีใช้คำสั่งเสียง:\n\n1. กดปุ่มไมค์สีแดง\n2. พูดสิ่งที่ต้องการ เช่น:\n   - "ขาดเงินค่าอาหาร"\n   - "อยากแลกไข่"\n   - "ช่วยทำเมนู"\n   - "สแกนอาหาร"\n   - "ดูโภชนาการเด็ก"\n   - "วัดน้ำหนักส่วนสูง"\n3. ระบบจะทำงานให้อัตโนมัติ\n\nลองเลย!');
            toggleVoice();
        }
        
        // Camera Functions
        function startCameraScanning() {
            const video = document.getElementById('cameraStream');
            const placeholder = document.getElementById('cameraPlaceholder');
            const scanButton = document.getElementById('scanButton');
            const captureButton = document.getElementById('captureButton');
            
            if (!isCameraActive) {
                // Request camera access
                navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
                    .then(function(mediaStream) {
                        stream = mediaStream;
                        video.srcObject = stream;
                        video.style.display = 'block';
                        placeholder.style.display = 'none';
                        scanButton.style.display = 'none';
                        captureButton.style.display = 'block';
                        isCameraActive = true;
                        showNotification('📸 กล้องพร้อมใช้งาน! กดถ่ายรูปเพื่อวิเคราะห์');
                    })
                    .catch(function(err) {
                        console.error("Error accessing camera: ", err);
                        alert('⚠️ ไม่สามารถเปิดกล้องได้\n\nกรุณาอนุญาตให้เว็บไซต์เข้าถึงกล้องของคุณ');
                    });
            }
        }
        
        function stopCamera() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                const video = document.getElementById('cameraStream');
                const placeholder = document.getElementById('cameraPlaceholder');
                const scanButton = document.getElementById('scanButton');
                const captureButton = document.getElementById('captureButton');
                
                video.style.display = 'none';
                placeholder.style.display = 'block';
                scanButton.style.display = 'block';
                captureButton.style.display = 'none';
                isCameraActive = false;
            }
        }
        
        function captureAndAnalyze() {
            showNotification('📸 กำลังวิเคราะห์...');
            
            // Simulate AI analysis
            setTimeout(() => {
                stopCamera();
                
                // Show scan result
                const scanResult = document.getElementById('scanResult');
                scanResult.classList.add('active');
                
                // Simulate different results
                const foods = [
                    { name: 'ไข่ไก่', energy: '155', protein: '13', fat: '11', carb: '1.1' },
                    { name: 'ผักคะน้า', energy: '28', protein: '2.8', fat: '0.7', carb: '5.6' },
                    { name: 'ปลานิล', energy: '128', protein: '26', fat: '2.7', carb: '0' }
                ];
                
                const randomFood = foods[Math.floor(Math.random() * foods.length)];
                
                scanResult.innerHTML = `
                    <h4>🍽️ ผลการสแกน: ${randomFood.name} (100 กรัม)</h4>
                    <div class="nutrition-info">
                        <div class="nutrition-item">
                            <h5>พลังงาน</h5>
                            <div class="value">${randomFood.energy} kcal</div>
                        </div>
                        <div class="nutrition-item">
                            <h5>โปรตีน</h5>
                            <div class="value">${randomFood.protein} g</div>
                        </div>
                        <div class="nutrition-item">
                            <h5>ไขมัน</h5>
                            <div class="value">${randomFood.fat} g</div>
                        </div>
                        <div class="nutrition-item">
                            <h5>คาร์โบไฮเดรต</h5>
                            <div class="value">${randomFood.carb} g</div>
                        </div>
                    </div>
                    <button class="action-btn" style="margin-top: 20px;" onclick="addToMenu()">
                        <span class="icon">➕</span>
                        <span>เพิ่มในเมนูวันนี้</span>
                    </button>
                `;
                
                showNotification(`✅ วิเคราะห์สำเร็จ! พบ: ${randomFood.name}`);
            }, 2000);
        }
        
        function addToMenu() {
            if (confirm('ต้องการเพิ่มวัตถุดิบนี้ในเมนูวันนี้ใช่ไหม?')) {
                showNotification('✅ เพิ่มในเมนูเรียบร้อย!');
                document.getElementById('scanResult').classList.remove('active');
            }
        }
        
        // Quick Solutions Functions
        function applyAllSolutions() {
            showNotification('⏳ กำลังดำเนินการ...');
            
            setTimeout(() => {
                alert('✅ ดำเนินการสำเร็จ!\n\n' +
                    '1. ✅ ส่งคำขอแลกไข่กับปลาแล้ว\n' +
                    '2. ✅ บันทึกการใช้ผักจากสวนโรงเรียน\n' +
                    '3. ✅ สั่งซื้อจากร้านป้าศรีแล้ว\n' +
                    '4. ✅ ส่งคำขอความช่วยเหลือแล้ว\n\n' +
                    'รวมประหยัดได้: 630 บาท\n' +
                    'งบประมาณพอสำหรับวันนี้แล้ว! 🎉');
                showScreen('dashboard');
            }, 2000);
        }
        
        function useFreeVegetables() {
            if (confirm('ใช้ผักจากสวนโรงเรียน?\n\n• ผักคะน้า 10 กก.\n• ผักบุ้ง 5 กก.\n\nประหยัดได้: 150 บาท')) {
                showNotification('✅ บันทึกการใช้ผักจากสวนโรงเรียนแล้ว');
            }
        }
        
        function showPartnerStores() {
            alert('🏪 ร้านค้าพันธมิตร\n\n' +
                '1. ร้านป้าศรี\n' +
                '   • ลด 10% ทุกรายการ\n' +
                '   • โทร: 089-123-4567\n\n' +
                '2. ร้านลุงมานพ\n' +
                '   • ผ่อน 0% 30 วัน\n' +
                '   • โทร: 089-234-5678\n\n' +
                '3. ตลาดสดชุมชน\n' +
                '   • ราคาพิเศษทุกเช้า\n' +
                '   • เปิด 5:00-8:00 น.');
        }
        
        // Exchange functions
        function confirmExchange(item) {
            const details = {
                'ปลานิล': {
                    message: 'แลกไข่ 30 ฟอง กับ ปลานิล 5 กก.',
                    saving: 200,
                    contact: 'ครูสมชาย 089-123-4567'
                },
                'ผักบุ้ง': {
                    message: 'แลกไข่ 20 ฟอง กับ ผักบุ้ง 10 กก.',
                    saving: 150,
                    contact: 'ครูมาลี 089-234-5678'
                }
            };
            
            const detail = details[item];
            if (confirm(`✅ ยืนยันการแลกเปลี่ยน\n\n${detail.message}\nประหยัดได้: ${detail.saving} บาท\n\nติดต่อ: ${detail.contact}\n\nต้องการแลกเปลี่ยนใช่ไหม?`)) {
                showNotification(`✅ แลกเปลี่ยนสำเร็จ! ประหยัดได้ ${detail.saving} บาท`);
                
                // Auto send message
                setTimeout(() => {
                    alert(`📱 ระบบได้ส่ง SMS ไปยัง ${detail.contact} แล้ว\n\nข้อความ: "สวัสดีค่ะ โรงเรียนบ้านดอยสูง ต้องการแลก${item} ตามที่ตกลง พรุ่งนี้เช้าสะดวกไหมคะ"`);
                }, 1000);
            }
        }
        
        function showMoreExchanges() {
            alert('🔄 ข้อเสนอแลกเปลี่ยนเพิ่มเติม\n\n' +
                '1. 🥛 นมสด 20 กล่อง\n   แลกกับ: ไข่ 15 ฟอง\n   จาก: โรงเรียนบ้านทุ่ง\n\n' +
                '2. 🌽 ข้าวโพด 10 กก.\n   แลกกับ: ผัก 5 กก.\n   จาก: โรงเรียนบ้านนา\n\n' +
                '3. 🍅 มะเขือเทศ 8 กก.\n   แลกกับ: ข้าวสาร 5 กก.\n   จาก: โรงเรียนบ้านสวน');
        }
        
        // AI Menu Generation
        function generateAIMenu() {
            showNotification('🤖 AI กำลังสร้างเมนู...');
            
            // Show loading
            const resultDiv = document.getElementById('ai-menu-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div style="text-align: center; padding: 50px;"><div class="loading"></div><p>กำลังคิดเมนูที่ดีที่สุดให้คุณ...</p></div>';
            
            // Simulate AI processing
            setTimeout(() => {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = `
                    <h3 style="margin: 30px 0;">📋 เมนูที่ AI แนะนำ</h3>
                    <div class="card">
                        <h4>เมนูประหยัด 5 วัน (เฉลี่ย 18 บาท/คน)</h4>
                        <div style="font-size: 18px; line-height: 2; margin-top: 20px;">
                            <p><strong>จันทร์:</strong> ข้าวผัดไข่ + ผักคะน้าลวก (17 บาท)</p>
                            <p><strong>อังคาร:</strong> ไข่พะโล้ + ผักบุ้งไฟแดง (19 บาท)</p>
                            <p><strong>พุธ:</strong> แกงจืดเต้าหู้ไข่ (16 บาท)</p>
                            <p><strong>พฤหัส:</strong> ผัดผักรวมใส่ไข่ (18 บาท)</p>
                            <p><strong>ศุกร์:</strong> ข้าวไข่เจียว + น้ำพริก (20 บาท)</p>
                        </div>
                        <div style="background: #E8F5E9; padding: 20px; border-radius: 10px; margin-top: 20px;">
                            <p><strong>✅ ประหยัดได้:</strong> 110 บาท/วัน</p>
                            <p><strong>✅ โภชนาการ:</strong> ครบ 5 หมู่ทุกมื้อ</p>
                            <p><strong>✅ ใช้วัตถุดิบที่มี:</strong> ไข่, ผัก, ข้าว</p>
                        </div>
                        <button class="action-btn" style="margin-top: 20px;" onclick="useAIMenu()">ใช้เมนูนี้</button>
                    </div>
                `;
                showNotification('✅ สร้างเมนูสำเร็จ! ประหยัดได้ 550 บาท/สัปดาห์');
            }, 2000);
        }
        
        function useAIMenu() {
            if (confirm('ต้องการใช้เมนูนี้สำหรับสัปดาห์หน้าใช่ไหม?')) {
                showNotification('✅ บันทึกเมนูสำเร็จ!');
                setTimeout(() => {
                    alert('📤 ระบบได้ส่งเมนูไปยัง:\n\n✅ กลุ่มไลน์ผู้ปกครอง\n✅ แม่ครัว\n✅ บอร์ดประชาสัมพันธ์\n\nเรียบร้อยแล้วค่ะ!');
                }, 500);
            }
        }
        
        // Community Help
        function sendHelpRequest() {
            const message = `📢 ส่งคำขอความช่วยเหลือ\n\n` +
                `ข้อความ: "โรงเรียนบ้านดอยสูง ขาดเงินค่าอาหาร 620 บาท สำหรับวันพรุ่งนี้ ขอความอนุเคราะห์จากชุมชนด้วยค่ะ"\n\n` +
                `จะส่งไปยัง:\n` +
                `✅ กลุ่มไลน์ชุมชน (156 คน)\n` +
                `✅ กลุ่มร้านค้าพันธมิตร (23 ร้าน)\n` +
                `✅ กลุ่มผู้ปกครอง (85 คน)\n\n` +
                `ต้องการส่งใช่ไหม?`;
                
            if (confirm(message)) {
                showNotification('📤 กำลังส่งคำขอ...');
                setTimeout(() => {
                    alert('✅ ส่งคำขอสำเร็จ!\n\nได้รับการตอบกลับแล้ว:\n\n👤 ป้าศรี: "ขอสนับสนุนข้าวสาร 10 กก. ค่ะ"\n👤 ลุงโต: "มีผักให้ฟรี 20 กก. มารับได้เลย"\n👤 คุณครูใหญ่บ้านแม่ปิง: "ขอสนับสนุน 200 บาท"\n\nรวมได้รับความช่วยเหลือ มูลค่า 650 บาท');
                }, 2000);
            }
        }
        
        function showAllPartners() {
            alert('🏪 ร้านค้าพันธมิตรทั้งหมด (23 ร้าน)\n\n' +
                'อาหารสด:\n' +
                '• ร้านป้าศรี - ลด 10%\n' +
                '• ร้านลุงมานพ - ผ่อน 0%\n' +
                '• ตลาดสดชุมชน - ราคาพิเศษ\n\n' +
                'ผัก/ผลไม้:\n' +
                '• สวนลุงโต - ผักฟรีทุกศุกร์\n' +
                '• สวนป้าแดง - ลด 15%\n' +
                '• ฟาร์มออร์แกนิค - ราคาพิเศษ\n\n' +
                'เนื้อสัตว์:\n' +
                '• บ่อปลาชุมชน - ราคาพิเศษ\n' +
                '• ฟาร์มไก่บ้านนา - ลด 20%');
        }
        
        function showDonationHistory() {
            alert('💝 ประวัติการสนับสนุน (30 วันล่าสุด)\n\n' +
                'มิถุนายน 2567:\n' +
                '• 15 มิ.ย. - คุณสมชาย - 500 บาท\n' +
                '• 10 มิ.ย. - สวนผักลุงใจดี - ผัก 20 กก.\n' +
                '• 5 มิ.ย. - ร้านข้าวป้าแดง - ข้าวสาร 10 กก.\n\n' +
                'พฤษภาคม 2567:\n' +
                '• 28 พ.ค. - กลุ่มผู้ปกครอง - 2,500 บาท\n' +
                '• 20 พ.ค. - วัดบ้านดอย - อาหารแห้ง\n' +
                '• 15 พ.ค. - อบต.ท้องถิ่น - 5,000 บาท\n\n' +
                'รวมมูลค่า: 15,850 บาท');
        }
        
        // Other detail functions
        function showBudgetDetail() {
            alert('💰 รายละเอียดงบประมาณ\n\n' +
                'รายรับ:\n' +
                '• จากรัฐบาล: 800 บาท\n' +
                '• เงินเหลือจากเมื่อวาน: 450 บาท\n' +
                'รวม: 1,250 บาท\n\n' +
                'รายจ่าย:\n' +
                '• ค่าอาหาร (85 คน x 22 บาท): 1,870 บาท\n\n' +
                'ขาด: 620 บาท ❌\n\n' +
                'กดปุ่ม "ดูวิธีแก้ปัญหา" เพื่อแก้ไข');
        }
        
        function showInventory() {
            showScreen('dashboard');
            alert('📦 วัตถุดิบทั้งหมด:\n\n' +
                '✅ มีเพียงพอ:\n' +
                '• ไข่ไก่ 120 ฟอง (พอ 3 วัน)\n' +
                '• ข้าวสาร 50 กก. (พอ 10 วัน)\n' +
                '• น้ำมัน 5 ลิตร (พอ 7 วัน)\n\n' +
                '⚠️ ใกล้หมด:\n' +
                '• ผักคะน้า 15 กก. (พอ 2 วัน)\n' +
                '• ซีอิ๊ว 2 ขวด (พอ 3 วัน)\n\n' +
                '❌ หมด:\n' +
                '• เนื้อสัตว์\n' +
                '• ผลไม้');
        }
        
        function showFullInventory() {
            alert('📦 คลังวัตถุดิบทั้งหมด\n\n' +
                'อาหารแห้ง:\n' +
                '• ข้าวสาร: 50 กก. ✅\n' +
                '• แป้งอเนกประสงค์: 5 กก. ✅\n' +
                '• น้ำตาล: 10 กก. ✅\n' +
                '• เกลือ: 3 กก. ✅\n\n' +
                'เครื่องปรุง:\n' +
                '• น้ำมัน: 5 ลิตร ✅\n' +
                '• ซีอิ๊ว: 2 ขวด ⚠️\n' +
                '• น้ำปลา: 3 ขวด ✅\n\n' +
                'อาหารสด:\n' +
                '• ไข่ไก่: 120 ฟอง ✅\n' +
                '• ผักคะน้า: 15 กก. ⚠️\n' +
                '• หอมแดง: 2 กก. ⚠️\n' +
                '• กระเทียม: 1 กก. ⚠️');
        }
        
        function showTodayMenu() {
            alert('🍛 เมนูวันนี้ (ศุกร์)\n\n' +
                'อาหารกลางวัน:\n' +
                '• ข้าวผัดไข่\n' +
                '• ผักคะน้านึ่ง\n' +
                '• น้ำเปล่า\n\n' +
                'โภชนาการ:\n' +
                '⭐⭐⭐⭐⭐ ครบ 5 หมู่\n\n' +
                'ต้นทุน: 22 บาท/คน\n' +
                'รวม: 1,870 บาท (85 คน)\n\n' +
                '⚠️ เงินไม่พอ ต้องหาเพิ่ม 620 บาท');
        }
        
        function playTutorial() {
            alert('🎥 วิดีโอสอนใช้งาน\n\nขออภัย ฟีเจอร์นี้กำลังพัฒนา\n\nสามารถโทรสอบถามได้ที่:\n📞 02-123-4567\n📱 Line: @schoolfoodhub');
        }
        
        // Notification system
        function showNotification(message) {
            // Remove existing notifications
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            // Create new notification
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Initialize
        window.onload = function() {
            // Show welcome message for first-time users
            const isFirstTime = !localStorage.getItem('hasVisited');
            if (isFirstTime) {
                setTimeout(() => {
                    alert('🎉 ยินดีต้อนรับสู่ School Food Hub!\n\n' +
                        '✨ มีอะไรใหม่:\n' +
                        '• AI ช่วยแก้ปัญหาอัตโนมัติ\n' +
                        '• สั่งงานด้วยเสียงได้\n' +
                        '• ปุ่มใหญ่ มองเห็นชัด\n' +
                        '• สแกนอาหารดูโภชนาการ 📸\n' +
                        '• ติดตามภาวะโภชนาการเด็ก 📊\n' +
                        '• มีคำแนะนำทุกขั้นตอน\n\n' +
                        'ลองกดปุ่ม "แก้ปัญหาด่วน" ดูนะคะ!');
                    localStorage.setItem('hasVisited', 'true');
                }, 1000);
            }
            
            // Simulate real-time updates
            setInterval(() => {
                const hour = new Date().getHours();
                if (hour === 12 && currentScreen === 'home') {
                    showNotification('🔔 เตือน: ใกล้ถึงเวลาเสิร์ฟอาหารกลางวันแล้ว');
                }
            }, 60000); // Check every minute
        }
        
        // Nutrition Tracking Functions
        function startQuickMeasure() {
            const form = document.getElementById('quickMeasureForm');
            form.style.display = 'block';
            form.scrollIntoView({ behavior: 'smooth' });
            showNotification('📏 เริ่มวัดส่วนสูง-น้ำหนัก');
        }
        
        function cancelMeasure() {
            document.getElementById('quickMeasureForm').style.display = 'none';
        }
        
        function saveMeasurement() {
            const studentSelect = document.getElementById('studentSelect');
            const selectedStudent = studentSelect.options[studentSelect.selectedIndex].text;
            
            if (studentSelect.value === '') {
                alert('❗ กรุณาเลือกนักเรียนก่อนค่ะ');
                return;
            }
            
            showNotification('💾 กำลังบันทึกข้อมูล...');
            
            setTimeout(() => {
                alert('✅ บันทึกข้อมูลสำเร็จ!\n\n' + 
                    `นักเรียน: ${selectedStudent}\n` +
                    'น้ำหนัก: 25.5 กก.\n' +
                    'ส่วนสูง: 120 ซม.\n' +
                    'BMI: 17.7 (ปกติ)\n\n' +
                    'AI แนะนำ: ภาวะโภชนาการอยู่ในเกณฑ์ดี ควรรักษาระดับนี้ไว้');
                cancelMeasure();
            }, 1500);
        }
        
        function showRiskStudents() {
            alert('🚨 นักเรียนกลุ่มเสี่ยง (13 คน)\n\n' +
                'น้ำหนักต่ำกว่าเกณฑ์ (8 คน):\n' +
                '• ด.ช. สมชาย - น้ำหนัก 18 กก. (ต่ำกว่า 3 กก.)\n' +
                '• ด.ญ. มาลี - น้ำหนัก 17.5 กก. (ต่ำกว่า 2.5 กก.)\n' +
                '• และอื่นๆ...\n\n' +
                'น้ำหนักเกิน (5 คน):\n' +
                '• ด.ช. สมศักดิ์ - น้ำหนัก 45 กก. (เกิน 8 กก.)\n' +
                '• และอื่นๆ...\n\n' +
                'คำแนะนำ: ให้อาหารเสริมโปรตีนสูงสำหรับกลุ่มน้ำหนักต่ำ');
        }
        
        function showNutritionReport() {
            if (confirm('📊 รายงานภาวะโภชนาการ ม.ค. 2568\n\n' +
                '✅ พร้อมส่งให้:\n' +
                '• ผู้ปกครอง 85 คน\n' +
                '• สาธารณสุขอำเภอ\n' +
                '• ผู้อำนวยการโรงเรียน\n\n' +
                'ต้องการส่งรายงานเดี๋ยวนี้ไหม?')) {
                showNotification('📤 กำลังส่งรายงาน...');
                setTimeout(() => {
                    alert('✅ ส่งรายงานสำเร็จ!\n\n' +
                        '• ส่งทาง LINE ผู้ปกครอง: 85/85 ✓\n' +
                        '• ส่งอีเมล: สาธารณสุข ✓\n' +
                        '• พิมพ์รายงาน: 1 ชุด ✓');
                }, 2000);
            }
        }
        
        function showFoodRecommend() {
            alert('🍽️ เมนูแนะนำเพิ่มโภชนาการ\n\n' +
                'สำหรับเด็กน้ำหนักต่ำ:\n' +
                '• ไข่ตุ๋นเนื้อหมูสับ (โปรตีน 15g)\n' +
                '• ข้าวผัดปลาแห้ง (โปรตีน 18g)\n' +
                '• แกงจืดเต้าหู้หมูสับ (โปรตีน 12g)\n\n' +
                'สำหรับเพิ่มแคลเซียม:\n' +
                '• ต้มยำปลาซาร์ดีน (แคลเซียม 250mg)\n' +
                '• ผัดผักคะน้าใส่กุ้งแห้ง (แคลเซียม 180mg)\n' +
                '• น้ำเต้าหู้ผสมงาดำ (แคลเซียม 200mg)\n\n' +
                '💡 ใช้วัตถุดิบจากโครงการโรงเรียน ประหยัดได้ 60%');
        }
        
        function printNutritionReport() {
            if (confirm('🖨️ พิมพ์รายงานภาวะโภชนาการ\n\n' +
                'เลือกรูปแบบ:\n' +
                '1. รายงานแบบย่อ (2 หน้า)\n' +
                '2. รายงานแบบละเอียด (10 หน้า)\n' +
                '3. รายงานรายบุคคล (85 หน้า)\n\n' +
                'กด OK เพื่อพิมพ์รายงานแบบย่อ')) {
                showNotification('🖨️ กำลังเตรียมเอกสาร...');
                setTimeout(() => {
                    window.print();
                    alert('✅ พิมพ์รายงานสำเร็จ!\n\n' +
                        'เอกสารที่พิมพ์:\n' +
                        '• สรุปภาวะโภชนาการ\n' +
                        '• กราฟแนวโน้ม 6 เดือน\n' +
                        '• รายชื่อเด็กกลุ่มเสี่ยง\n' +
                        '• คำแนะนำการดูแล');
                }, 1500);
            }
        }
        
        // Keyboard shortcuts for easier navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'F1') {
                e.preventDefault();
                alert('⌨️ ปุ่มลัด:\n\n' +
                    'F1 - ดูวิธีใช้\n' +
                    'F2 - เริ่มฟังคำสั่งเสียง\n' +
                    'F3 - ไปหน้าแลกเปลี่ยน\n' +
                    'F4 - ให้ AI ช่วยเมนู\n' +
                    'F5 - เปิดกล้องสแกน\n' +
                    'F6 - ติดตามโภชนาการ\n' +
                    'ESC - กลับหน้าหลัก');
            } else if (e.key === 'F2') {
                e.preventDefault();
                toggleVoice();
            } else if (e.key === 'F3') {
                e.preventDefault();
                showScreen('exchange');
            } else if (e.key === 'F4') {
                e.preventDefault();
                showScreen('ai-menu');
            } else if (e.key === 'F5') {
                e.preventDefault();
                showScreen('ai-menu');
                startCameraScanning();
            } else if (e.key === 'F6') {
                e.preventDefault();
                showScreen('nutrition');
            } else if (e.key === 'Escape') {
                e.preventDefault();
                showScreen('home');
            }
        });
        
        // Clean up camera when page unloads
        window.addEventListener('beforeunload', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
        });
    </script>
</body>
</html>